<?xml version="1.0" encoding="UTF-8"?>
<HBRRepo>
  <variables>
    <variable id="1" name="СПИСОК_ПЕРИОД" product="Planning" type="members" usage="const">
      <property name="array_type">string</property>
      <property name="dimension">ПЕРИОД</property>
      <property name="dimensionInputMode">name</property>
      <property name="prompt_text">Выберите 1 или несколько месяцев</property>
      <property name="scope">ruleset</property>
      <property name="useLastValue">true</property>
      <value>"Всего год"</value>
    </variable>
    <variable id="2" name="ГОД" product="Planning" type="member" usage="const">
      <property name="array_type">string</property>
      <property name="dimensionInputMode">type</property>
      <property name="dimensionType">Year</property>
      <property name="prompt_text">Выберите Год</property>
      <property name="scope">ruleset</property>
      <value>FY18</value>
    </variable>
    <variable id="3" name="ВЕРСИЯ" product="Planning" type="member" usage="const">
      <property name="array_type">string</property>
      <property name="dimensionInputMode">type</property>
      <property name="dimensionType">Version</property>
      <property name="prompt_text">Выберите Версию</property>
      <property name="scope">ruleset</property>
      <value>Рабочая_1</value>
    </variable>
    <variable id="4" name="СЦЕНАРИЙ" product="Planning" type="member" usage="const">
      <property name="array_type">string</property>
      <property name="dimensionInputMode">type</property>
      <property name="dimensionType">Scenario</property>
      <property name="prompt_text">Выберите Сценарий</property>
      <property name="scope">ruleset</property>
      <value>Проект</value>
    </variable>
    <variable id="5" name="МВЗ" product="Planning" type="member" usage="const">
      <property name="array_type">string</property>
      <property name="dimension">МВЗ</property>
      <property name="dimensionInputMode">name</property>
      <property name="prompt_text">Выберите МВЗ</property>
      <property name="scope">ruleset</property>
      <value>"Итого по МВЗ"</value>
    </variable>
  </variables>
  <rulesets></rulesets>
  <rules>
    <rule id="1" name="0.0.х.Переносим в смету Цены из 6.15" product="Planning">
      <property name="application">ТЧМ</property>
      <property name="plantype">Plan1</property>
      <property name="display_label">0.0.х.Переносим в смету Цены из 6.15</property>
      <variable_references>
        <variable_reference id="3" name="ВЕРСИЯ">
          <property name="hasvalue">true</property>
          <property name="hidden">false</property>
          <property name="rule_name">0.0.х.Переносим в смету Цены из 6.15</property>
          <property name="seq">1</property>
          <property name="type">3</property>
          <property name="useAsOverrideValue">false</property>
        </variable_reference>
        <variable_reference id="2" name="ГОД">
          <property name="hasvalue">true</property>
          <property name="hidden">false</property>
          <property name="rule_name">0.0.х.Переносим в смету Цены из 6.15</property>
          <property name="seq">2</property>
          <property name="type">3</property>
          <property name="useAsOverrideValue">false</property>
        </variable_reference>
        <variable_reference id="4" name="СЦЕНАРИЙ">
          <property name="hasvalue">true</property>
          <property name="hidden">false</property>
          <property name="rule_name">0.0.х.Переносим в смету Цены из 6.15</property>
          <property name="seq">3</property>
          <property name="type">3</property>
          <property name="useAsOverrideValue">false</property>
        </variable_reference>
        <variable_reference id="5" name="МВЗ">
          <property name="hasvalue">true</property>
          <property name="hidden">false</property>
          <property name="rule_name">0.0.х.Переносим в смету Цены из 6.15</property>
          <property name="seq">4</property>
          <property name="type">3</property>
          <property name="useAsOverrideValue">false</property>
        </variable_reference>
        <variable_reference id="1" name="СПИСОК_ПЕРИОД">
          <property name="hasvalue">true</property>
          <property name="hidden">false</property>
          <property name="rule_name">0.0.х.Переносим в смету Цены из 6.15</property>
          <property name="seq">5</property>
          <property name="type">4</property>
          <property name="useAsOverrideValue">false</property>
        </variable_reference>
      </variable_references>
      <script><![CDATA[SET AGGMISSG ON;
SET UPDATECALC OFF;
SET CREATEBLOCKONEQ OFF;
SET CREATENONMISSINGBLK OFF;
SET FRMLBOTTOMUP OFF;
SET REMOTECALC OFF;
SET CALCPARALLEL 1;
SET CALCTASKDIMS 1;
SET EMPTYMEMBERSETS ON;
SET FRMLRTDYNAMIC OFF;
SET MSG INFO;
/* Проверка корректности рассчитываемого среза данных */

FIX(
/* ВАЛЮТА							*/	"бу валюты"
/* ПЕРИОД							*/	"P0"
/* ГОД								*/	"No Year"
/* ВЕРСИЯ							*/	
/* СЦЕНАРИЙ							*/	
/* ЦФО								*/	"бу ЦФО"
/* МВЗ								*/	"бу МВЗ"
/* МВЗ ПОЛУЧАТЕЛЬ					*/	"бу МВЗ (пол-ль)"
/* СЧЕТА БАЛАНСА					*/	"80_Увеличение"
/* СТАТЬИ							*/	
/* ПОКАЗАТЕЛИ						*/	"Сумма"
/* ВИД ЗАТРАТ						*/	"бу видов затрат"
/* ПРОДУКЦИЯ						*/	"бу вида продукции"
/* КОНТРАГЕНТЫ						*/	"бу контрагента"
/* НАПРАВЛЕНИЕ	*/	"бу направления"
/* ЭЛЕМЕНТЫ_ЗАТРАТ					*/	"бу элемента затрат"
/* ПРОЧЕЕ							*/	"бу прочих справочников"

)
  SET CREATENONMISSINGBLK ON;

  
  var ErrFlagScenario=0;
  var ErrFlagVersion=0;
  var NextM=2;
  /* ПРОВЕРКА КОРРЕКТНОСТИ ВЫБОРА СЦЕНАРИЯ */
  FIX(/* Сценарий */ {СЦЕНАРИЙ} AND @LIST(&ОТКРЫТЫЕ_СЦЕНАРИИ))
    FIX(
    /* Сценарий */ 
    /* Версия   */ "Рабочая 1"
    )
     "бу статьи" (
     IF (ErrFlagScenario==0)
            ErrFlagScenario=1;
     ENDIF
     );

    ENDFIX
  ENDFIX

   /* ПРОВЕРКА КОРРЕКТНОСТИ ВЫБОРА ВЕРСИИ */
  FIX(/* Версия  */ {ВЕРСИЯ} AND @LIST(&ОТКРЫТЫЕ_ВЕРСИИ))
    FIX(
    /* Сценарий */ "Проект"
    /* Версия   */ 
    )
     "бу статьи" (
     IF (ErrFlagVersion==0)
            ErrFlagVersion=1;
     ENDIF
     );
    ENDFIX
  ENDFIX

  /* ВЫВОД СООБЩЕНИЙ О НЕКОРРЕКТНОМ СРЕЗЕ */
  FIX(
  /* Сценарий     */ "Проект"
  /* Версия       */ "Рабочая 1"
  )

   "бу статьи" (
    IF (ErrFlagScenario==0)
       @RETURN("Выбран сценарий, закрытый для расчета. Расчет не произведен.",ERROR);
    ENDIF
    IF (ErrFlagVersion==0)
       @RETURN("Выбрана версия, закрытая для расчета. Расчет не произведен.",ERROR);
    ENDIF
    )

   ENDFIX
ENDFIX
SET CREATENONMISSINGBLK OFF;
FIX(
/*ЭЛЕМЕНТЫ_ЗАТРАТ                  */"бу элемента затрат"
/*ЦФО                           */"ПЭО"
/*ВАЛЮТА                        */"RUR"
/*МВЗ ПОЛУЧАТЕЛЬ                  */"бу МВЗ (пол-ль)"
/*КОНТРАГЕНТЫ                     */"бу контрагента"
/*НАПРАВЛЕНИЕ                     */"бу направления"
/*ПРОЧЕЕ                        */"бу прочих справочников"
/*СЧЕТА БАЛАНСА                     */"20_Начисление"
/*ГОД                           */{ГОД}
/*ВЕРСИЯ                        */{ВЕРСИЯ}
/*МВЗ                           */
/*ПЕРИОД                        */@ILDESCENDANTS({СПИСОК_ПЕРИОД}) and @RELATIVE("Всего год",0)
/*СЦЕНАРИЙ                        */{СЦЕНАРИЙ}
/*СТАТЬИ                        */
/*ВИД ЗАТРАТ                     */

)


/*Докручиваем стоимость сырья из формы 6.15*/

/*Доменные печи*/
FIX(
/*МВЗ                           */@RELATIVE("Доменные печи",0) and @RELATIVE({МВЗ},0)
)
FIX(
/*ПРОДУКЦИЯ                        */@RELATIVE("Чугун",0)
)
FIX( 
/*ВИД ЗАТРАТ                     */"Агломерат бункерный.","Агломерат скиповый","Отсев агломерата","Окатыши МГОК","Окатыши ЛГОК","Окатыши Карельские","Руда марганцевая","Скрап переработанный","МК-50","МК-80","МК-250","Шлак металлургический","Известняк фр. 40-70"
/*СТАТЬИ                        */"Сырье и основные материалы."
)

"Цена"("ОПР Доменный цех"->"бу контрагента"->"бу направления"->"бу вида продукции"->"Прочее по ЭР"->"ПЭО"->"бу элемента затрат"->"Сырье."->"10_Списание"->"бу МВЗ (пол-ль)"->"Цена."->"RUR";)

"Сумма"(
		IF("Кол-во" * "ОПР Доменный цех"->"бу контрагента"->"бу направления"->"бу вида продукции"->"Прочее по ЭР"->"ПЭО"->"бу элемента затрат"->"Сырье."->"10_Списание"->"бу МВЗ (пол-ль)"->"Цена."->"RUR" + 0 <> 0)
			"Кол-во" * "ОПР Доменный цех"->"бу контрагента"->"бу направления"->"бу вида продукции"->"Прочее по ЭР"->"ПЭО"->"бу элемента затрат"->"Сырье."->"10_Списание"->"бу МВЗ (пол-ль)"->"Цена."->"RUR";
        ELSE
         	#missing;
		ENDIF)

"Кол-во на ед"("Кол-во"/"Кол-во"->"Кол-во с учетом годного выхода."->"бу видов затрат";)
"Сумма на ед"("Сумма"/"Кол-во"->"Кол-во с учетом годного выхода."->"бу видов затрат";)
"Структура"("Сумма"/"Сумма"->"СЕБЕСТОИМОСТЬ ТОВАРНОЙ ПРОДУКЦИИ FCA"->"бу видов затрат";)

ENDFIX

FIX( 
/*ВИД ЗАТРАТ                     */"Кокс влажный металлургический","Коксовая мелочь с печей","Коксовая мелочь с РВО"/*,"Коксовый орех с РВО"*/,"Кокс влажный скиповой","Коксовый орех"
/*СТАТЬИ                        */"Топливо технологическое."
)
"Цена"("ОПР Доменный цех"->"бу контрагента"->"бу направления"->"бу вида продукции"->"Прочее по ЭР"->"ПЭО"->"бу элемента затрат"->"Сырье."->"10_Списание"->"бу МВЗ (пол-ль)"->"Цена."->"RUR";)
	
    "Сумма"(
	IF("Цена"+0<>0 and "Кол-во"+0<>0)
		"Сумма"="Цена"*"Кол-во";
    ELSE
    	"Сумма"= #missing;
	ENDIF
	)
"Кол-во на ед"("Кол-во"/"Кол-во"->"Кол-во с учетом годного выхода."->"бу видов затрат";)
"Сумма на ед"("Сумма"/"Кол-во"->"Кол-во с учетом годного выхода."->"бу видов затрат";)
"Структура"("Сумма"/"Сумма"->"СЕБЕСТОИМОСТЬ ТОВАРНОЙ ПРОДУКЦИИ FCA"->"бу видов затрат";)

ENDFIX
ENDFIX
ENDFIX

/*Аглоцех */
FIX(
/*МВЗ                           */"№1. Аглоцех" and @RELATIVE({МВЗ},0)
)
FIX(
/*ПРОДУКЦИЯ                        */"Агломерат бункерный"
)
FIX( 
/*ВИД ЗАТРАТ                     */"Отсев агломерата","Концентрат КМА","Концентрат ЛГОК","Концентрат МГОК","Концентрат СГОК","Аглоруда Яковлевская","Материалы железосодержащие с УОШ","Шлам по ТУ 14-127-330","Материалы железосодержащие АС","Пыль колошниковая","МК-10","Флюс мелкофракционный АС","Известняк фр. 0-20","Известняк фр. 20-40","Коксовая мелочь с РВО","Коксовая мелочь с печей"
/*СТАТЬИ                        */"Сырье и основные материалы."
)
"Цена"("бу контрагента"->"бу направления"->"бу вида продукции"->"Прочее по ЭР"->"ПЭО"->"бу элемента затрат"->"ПОЛНАЯ СЕБЕСТОИМОСТЬ:"->"10_Списание"->"бу МВЗ (пол-ль)"->"Цена."->"RUR";)

"Сумма"( 
	IF("Кол-во" + "Цена"+0<>0)
		"Кол-во" * "Цена";
    ELSE
    	#missing;
	ENDIF
    )
"Кол-во на ед"("Кол-во"/"Кол-во"->"Кол-во с учетом годного выхода."->"бу видов затрат";)
"Сумма на ед"("Сумма"/"Кол-во"->"Кол-во с учетом годного выхода."->"бу видов затрат";)
"Структура"("Сумма"/"Сумма"->"СЕБЕСТОИМОСТЬ ТОВАРНОЙ ПРОДУКЦИИ FCA"->"бу видов затрат";)

ENDFIX
ENDFIX 
ENDFIX 

/*ЦПДМШ */
FIX(
/*МВЗ                           */@RELATIVE("№6. ЦПДМШ",0) and @RELATIVE({МВЗ},0)
)
FIX(
/*ПРОДУКЦИЯ                        */"Щебень шлаковый","Щебень шлаковый в целом","Щебень шлаковый фр.5-20","Щебень шлаковый фр.10-40","Щебень шлаковый фр.20-40","Щебень шлаковый смесь 20-70.","Щебень шлаковый фр.40-70","Щебень шлаковый фр.50-250","Песок шлаковый фр. 0-5","Щебеночно-песчаная смесь фр. 0-10","Щебеночно-песчаная смесь фр. 0-70","Услуги по взвешиванию щебня","Скрап дробленый","Металлодобавка.","Чугун дробленый шлаковый","МК-250.","МК-80.","МК-50.","МК-10.","Скрап переработанный.","Огневая резка металлолом","Окалина переработанная"
)
FIX( 
/*ВИД ЗАТРАТ                     */"МК-10","МК-50","МК-80","МК-250","Огневая резка (металлолом)","Скрап с разливочных машин","Графитовый чугунный скрап",/*"Скрап переработанный" возвращаем калькулятором,*/"Лом черных металлов в целом","5 А Негабарит.стальной лом и отходы","20 А  Брак чугун.литья (негабарит)"
/*СТАТЬИ                        */"Сырье и основные материалы."
)
"Цена"("ОПР ЦПДМШ"->"бу контрагента"->"бу направления"->"бу вида продукции"->"Прочее по ЭР"->"ПЭО"->"бу элемента затрат"->"Сырье."->"10_Списание"->"бу МВЗ (пол-ль)"->"Цена."->"RUR";)
"Сумма"( 
	IF("Кол-во" + "Цена"+0<>0)
		"Кол-во" * "Цена";
    ELSE
    	#missing;
	ENDIF
    )
    
"Кол-во на ед"("Кол-во"/"Кол-во"->"Кол-во с учетом годного выхода."->"бу видов затрат";)
"Сумма на ед"("Сумма"/"Кол-во"->"Кол-во с учетом годного выхода."->"бу видов затрат";)
"Структура"("Сумма"/"Сумма"->"СЕБЕСТОИМОСТЬ ТОВАРНОЙ ПРОДУКЦИИ FCA"->"бу видов затрат";)

ENDFIX
ENDFIX 
ENDFIX

ENDFIX
/* Кокс, угар, агломерат 
   Перенос цен  из формы 6.15.1.Кокс в калькуляции ДЦ
   Перенос цен Агломерата скипового и Отсева агломерата
   Расчет кол-ва по угару */

/* Перенос цен Кокса */
FIX(
/*НАПРАВЛЕНИЕ 								*/"бу направления"
/*ПРОДУКЦИЯ 								*/@RELATIVE("Чугун",0)
/*ПРОЧЕЕ 									*/"бу прочих справочников"
/*ЭЛЕМЕНТЫ_ЗАТРАТ 							*/"бу элемента затрат"
/*ЦФО 										*/"ПЭО"
/*ВАЛЮТА 									*/"RUR"
/*КОНТРАГЕНТЫ 								*/"бу контрагента"
/*МВЗ ПОЛУЧАТЕЛЬ 							*/"бу МВЗ (пол-ль)"
/*МВЗ 										*/@RELATIVE("№2. Доменный цех",0)
/*СЧЕТА БАЛАНСА 							*/"20_Начисление"
/*СЦЕНАРИЙ 									*/{СЦЕНАРИЙ}
/*ВЕРСИЯ 									*/{ВЕРСИЯ}
/*ГОД 										*/{ГОД}
/*ВИД ЗАТРАТ 								*/"Кокс влажный скиповой","Коксовый орех","Коксовая мелочь с печей","Коксовая мелочь с РВО","Коксовый орех с РВО","Агломерат скиповый", "Отсев агломерата"
/*СТАТЬИ 									*/@RELATIVE("ЦЕХОВАЯ СЕБЕСТОИМОСТЬ",0)
/*ПЕРИОД 									*/@RELATIVE("Итого год",0)
/*ПОКАЗАТЕЛИ 								*/
)

/* Перенос цены  из формы 6.15.1.Кокс в калькуляции ДЦ (кокс и агломерат)*/
	"Цена"(
	IF("Кол-во"+0>0 and "ОПР Доменный цех"->"бу вида продукции"->"Прочее по ЭР"->"ПЭО"->"бу статьи"->"бу счета баланса" + 0 <> 0)
		"ОПР Доменный цех"->"бу вида продукции"->"Прочее по ЭР"->"ПЭО"->"бу статьи"->"бу счета баланса";	
	ENDIF
	)

	"Сумма"(
	IF("Цена"+0<>0 and "Кол-во"+0<>0)
		"Сумма"="Цена"*"Кол-во";
    ELSE
    	"Сумма"= #missing;
	ENDIF
	)
ENDFIX

/* Расчет по ВЗ "Угар" */
FIX(
/*ЭЛЕМЕНТЫ_ЗАТРАТ					 */"бу элемента затрат"
/*ЦФО 						  		 */"ПЭО"
/*КОНТРАГЕНТЫ 						 */"бу контрагента"
/*НАПРАВЛЕНИЕ 	 			         */"бу направления"
/*ПРОЧЕЕ 							 */"бу прочих справочников"
/*СЧЕТА БАЛАНСА                      */"20_Начисление"
/*МВЗ ПОЛУЧАТЕЛЬ 					 */"бу МВЗ (пол-ль)"
/*ВАЛЮТА 							 */"RUR"
/*ВИД ЗАТРАТ 						 */
/*СТАТЬИ							 */
/*СЦЕНАРИЙ							 */{СЦЕНАРИЙ}
/*ПЕРИОД							 */@RELATIVE("Итого год",0)
/*ВЕРСИЯ 							 */{ВЕРСИЯ}
/*ГОД 								 */{ГОД}
/*ПРОДУКЦИЯ 						 */@RELATIVE("Чугун",0)
/*ПОКАЗАТЕЛИ 						 */
/*МВЗ 								 */
)

/* Рассчитываем кол-во с отрицательным знаком для исключения отсева агломерата из Железорудного сырья */
	FIX(
	/*МВЗ 								*/@RELATIVE("Доменные печи",0)
	/*Статья							*/"Сырье и основные материалы."
	/*ВИД ЗАТРАТ						*/"Отсев агломерата (минус по кол-ву)"
	/*ПОКАЗАТЕЛИ 						*/
	)
	
	SET CREATENONMISSINGBLK ON;
	
		"Кол-во" = -"Кол-во"->"Отсев агломерата";
	ENDFIX

	FIX(
	/*МВЗ 								*/@RELATIVE("Доменные печи",0)
	/*Статья							*/"Отходы производства"
	/*ВИД ЗАТРАТ						*/"Угар"
	/*ПОКАЗАТЕЛИ 						*/
	)

	/*Итого задано без учета отходов - возвратные отходы - 1. Количество на все производство получается путем умножения кол-ва угара на единицу
	и объема пр-ва. ПРИ РАСЧЕТЕ КОЛ-ВА НА ЕДИНИЦУ НЕ НАДО УЧИТЫВАТЬ ТОПЛИВО ТЕХНОЛОГИЧЕСКОЕ!*/
		"Кол-во" (
        "Кол-во" = #MISSING;
		IF ("Кол-во"->"Всего по видам затрат"+0<>0)
			"Кол-во" 
				= "Сырье и основные материалы."->"Металлошихта"
                - "Возвратные отходы"
                - "Кол-во с учетом годного выхода."->"бу видов затрат" ;
				/*("Итого задано до вычета отходов"->"Всего по видам затрат"
                -"Топливо технологическое."->"Топливо технологическое")
				/"Кол-во с учетом годного выхода."->"бу видов затрат"
				- "Возвратные отходы"
				/"Кол-во с учетом годного выхода."->"бу видов затрат" 
				- 1)
				* "Кол-во с учетом годного выхода."->"бу видов затрат"*/
		ENDIF
		)
        
	SET CREATENONMISSINGBLK OFF;

	ENDFIX
   
	
	/* Очистка металлодобавки в целом */
	FIX(
	/*МВЗ 								*/@RELATIVE("Доменные печи",0)
	/*Статья							*/"Сырье и основные материалы."
	/*ВИД ЗАТРАТ						*/
	/*ПОКАЗАТЕЛИ 						*/"Кол-во"
	)
		CLEARDATA "Металлодобавка в целом";
    
	ENDFIX
	
	FIX(
	/*МВЗ 								*/@RELATIVE("Доменные печи",0)
	/*Статья							*/"Отходы производства"
	/*ВИД ЗАТРАТ						*/"Угар"
	/*ПОКАЗАТЕЛИ 						*/
	)

	/*Итого задано без учета отходов - возвратные отходы - 1. Количество на все производство получается путем умножения кол-ва угара на единицу
	и объема пр-ва. ПРИ РАСЧЕТЕ КОЛ-ВА НА ЕДИНИЦУ НЕ НАДО УЧИТЫВАТЬ ТОПЛИВО ТЕХНОЛОГИЧЕСКОЕ!*/
		"Кол-во" (
        "Кол-во" = #MISSING;
		IF ("Кол-во"->"Всего по видам затрат"+0<>0)
			"Кол-во" 
				= "Сырье и основные материалы."->"Металлошихта"
                - "Возвратные отходы"
                - "Кол-во с учетом годного выхода."->"бу видов затрат" ;
				/*("Итого задано до вычета отходов"->"Всего по видам затрат"
                -"Топливо технологическое."->"Топливо технологическое")
				/"Кол-во с учетом годного выхода."->"бу видов затрат"
				- "Возвратные отходы"
				/"Кол-во с учетом годного выхода."->"бу видов затрат" 
				- 1)
				* "Кол-во с учетом годного выхода."->"бу видов затрат"*/
		ENDIF
		)
        
	SET CREATENONMISSINGBLK OFF;

	ENDFIX
	
	/* Расчет проверочного показателя Кол-во на ед. */
	FIX(
	/*МВЗ 								*/@RELATIVE("Доменные печи",0)
	/*Статья							*/"Итого задано ресурсов с учетом отходов (без кол-ва топлива)"
	/*ВИД ЗАТРАТ						*/"бу видов затрат" 
	/*ПОКАЗАТЕЛИ 						*/
	)
    
	SET CREATENONMISSINGBLK ON;

    	"Кол-во" (
        "Кол-во" = #MISSING;
        "Сумма"  = #MISSING;
		IF ("Кол-во"->"Итого задано ресурсов с учетом отходов"->"Всего по видам затрат"+0<>0)
            "Кол-во" 
            	= "Итого задано до вычета отходов"->"Всего по видам затрат" 
                - "Топливо технологическое."->"Топливо технологическое"
				- "Отходы производства"->"Всего по видам затрат";
            "Сумма" 
            	= "Сумма"->"Итого задано ресурсов с учетом отходов"->"Всего по видам затрат"
            	+ "Сумма"->"Итого задано ресурсов с учетом отходов"->"Всего по видам затрат"->"№2. Доменный цех (пол-ль)";
        ENDIF
        )
	SET CREATENONMISSINGBLK OFF;

    ENDFIX
    
    CLEARBLOCK EMPTY;
    	
ENDFIX
FIX(
/*ЭЛЕМЕНТЫ_ЗАТРАТ						*/"бу элемента затрат"
/*ЦФО									*/"ПЭО"
/*ВАЛЮТА								*/"RUR"
/*МВЗ ПОЛУЧАТЕЛЬ						*/@Relative("Итого по МВЗ (пол-ль)", 0)
/*КОНТРАГЕНТЫ							*/"бу контрагента"
/*НАПРАВЛЕНИЕ							*/"бу направления"
/*ПРОЧЕЕ								*/"бу прочих справочников"
/*СЧЕТА БАЛАНСА							*/"20_Начисление"
/*ГОД									*/{ГОД}
/*ВЕРСИЯ								*/{ВЕРСИЯ}
/*МВЗ									*/@RELATIVE({МВЗ},0)
/*ПЕРИОД								*/@ILDESCENDANTS({СПИСОК_ПЕРИОД}) and @RELATIVE("Всего год",0)
/*СЦЕНАРИЙ								*/{СЦЕНАРИЙ}
/*СТАТЬИ								*/@Relative("ПОЛНАЯ СЕБЕСТОИМОСТЬ", 0)
/*ВИД ЗАТРАТ							*/@Relative("Итого по видам затрат", 0)
/*ПРОДУКЦИЯ								*/@Relative("Итого по продукции", 0)
)


"Кол-во на ед"("Кол-во"/"Кол-во"->"бу видов затрат"->"бу контрагента"->"бу направления"->"ПЭО"->"Кол-во с учетом годного выхода."->"20_Начисление"->"RUR"->"бу МВЗ (пол-ль)";)
"Сумма на ед"("Сумма"/"Кол-во"->"бу видов затрат"->"бу контрагента"->"бу направления"->"ПЭО"->"Кол-во с учетом годного выхода."->"20_Начисление"->"RUR"->"бу МВЗ (пол-ль)";)
"Структура"("Сумма"/"Сумма"->"СЕБЕСТОИМОСТЬ ТОВАРНОЙ ПРОДУКЦИИ FCA"->"бу видов затрат"->"бу МВЗ (пол-ль)";)




ENDFIX]]></script>
    </rule>
  </rules>
  <components></components>
</HBRRepo>