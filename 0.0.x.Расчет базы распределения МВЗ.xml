<?xml version="1.0" encoding="UTF-8"?>
<HBRRepo>
  <variables>
    <variable id="1" name="СПИСОК_ПЕРИОД" product="Planning" type="members" usage="const">
      <property name="array_type">string</property>
      <property name="dimension">ПЕРИОД</property>
      <property name="dimensionInputMode">name</property>
      <property name="prompt_text">Выберите 1 или несколько месяцев</property>
      <property name="scope">ruleset</property>
      <property name="useLastValue">true</property>
      <value>"Всего год"</value>
    </variable>
    <variable id="2" name="ГОД" product="Planning" type="member" usage="const">
      <property name="array_type">string</property>
      <property name="dimensionInputMode">type</property>
      <property name="dimensionType">Year</property>
      <property name="prompt_text">Выберите Год</property>
      <property name="scope">ruleset</property>
      <value>FY18</value>
    </variable>
    <variable id="3" name="ВЕРСИЯ" product="Planning" type="member" usage="const">
      <property name="array_type">string</property>
      <property name="dimensionInputMode">type</property>
      <property name="dimensionType">Version</property>
      <property name="prompt_text">Выберите Версию</property>
      <property name="scope">ruleset</property>
      <value>Рабочая_1</value>
    </variable>
    <variable id="4" name="СЦЕНАРИЙ" product="Planning" type="member" usage="const">
      <property name="array_type">string</property>
      <property name="dimensionInputMode">type</property>
      <property name="dimensionType">Scenario</property>
      <property name="prompt_text">Выберите Сценарий</property>
      <property name="scope">ruleset</property>
      <value>Проект</value>
    </variable>
    <variable id="5" name="МВЗ" product="Planning" type="member" usage="const">
      <property name="array_type">string</property>
      <property name="dimension">МВЗ</property>
      <property name="dimensionInputMode">name</property>
      <property name="prompt_text">Выберите МВЗ</property>
      <property name="scope">ruleset</property>
      <value>"Итого по МВЗ"</value>
    </variable>
  </variables>
  <rulesets></rulesets>
  <rules>
    <rule id="1" name="0.0.x.Расчет базы распределения МВЗ" product="Planning">
      <property name="description">Тиражирование драйверов на получателей, расчет базы распределения ТЧМ и ТЧМС</property>
      <property name="application">ТЧМ</property>
      <property name="plantype">Plan2</property>
      <property name="display_label">0.0.x.Расчет базы распределения МВЗ</property>
      <property name="enableNotifications">false</property>
      <property name="enablePostProcessing">false</property>
      <property name="enablePreProcessing">false</property>
      <variable_references>
        <variable_reference id="2" name="ГОД">
          <property name="hasvalue">true</property>
          <property name="hidden">false</property>
          <property name="rule_name">0.0.x.Расчет базы распределения МВЗ</property>
          <property name="seq">1</property>
          <property name="type">3</property>
          <property name="useAsOverrideValue">false</property>
        </variable_reference>
        <variable_reference id="3" name="ВЕРСИЯ">
          <property name="hasvalue">true</property>
          <property name="hidden">false</property>
          <property name="rule_name">0.0.x.Расчет базы распределения МВЗ</property>
          <property name="seq">2</property>
          <property name="type">3</property>
          <property name="useAsOverrideValue">false</property>
        </variable_reference>
        <variable_reference id="4" name="СЦЕНАРИЙ">
          <property name="hasvalue">true</property>
          <property name="hidden">false</property>
          <property name="rule_name">0.0.x.Расчет базы распределения МВЗ</property>
          <property name="seq">3</property>
          <property name="type">3</property>
          <property name="useAsOverrideValue">false</property>
        </variable_reference>
        <variable_reference id="5" name="МВЗ">
          <property name="hasvalue">true</property>
          <property name="hidden">false</property>
          <property name="rule_name">0.0.x.Расчет базы распределения МВЗ</property>
          <property name="seq">4</property>
          <property name="type">3</property>
          <property name="useAsOverrideValue">false</property>
        </variable_reference>
        <variable_reference id="1" name="СПИСОК_ПЕРИОД">
          <property name="hasvalue">true</property>
          <property name="hidden">false</property>
          <property name="rule_name">0.0.x.Расчет базы распределения МВЗ</property>
          <property name="seq">5</property>
          <property name="type">4</property>
          <property name="useAsOverrideValue">false</property>
        </variable_reference>
      </variable_references>
      <script><![CDATA[SET AGGMISSG ON;
SET UPDATECALC OFF;
SET CREATEBLOCKONEQ OFF;
SET CREATENONMISSINGBLK OFF;
SET FRMLBOTTOMUP OFF;
SET REMOTECALC OFF;
SET CALCPARALLEL 1;
SET CALCTASKDIMS 1;
SET EMPTYMEMBERSETS ON;
SET FRMLRTDYNAMIC OFF;
SET MSG INFO;
/* Проверка корректности рассчитываемого среза данных */

FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ				*/  "бу видов затрат (пол-ль)"
/*ПРОДУКТ ПОЛУЧАТЕЛЬ				*/  "бу вида продукции (пол-ль)"
/* ВАЛЮТА							*/	"бу валюты"
/* ПЕРИОД							*/	"P0"
/* ГОД								*/	"No Year"
/* ВЕРСИЯ							*/	
/* СЦЕНАРИЙ							*/	
/* ЦФО								*/	"бу ЦФО"
/* МВЗ								*/	"бу МВЗ"
/* СЧЕТА БАЛАНСА					*/	"20_Начисление"
/* СТАТЬИ							*/	
/* ПОКАЗАТЕЛИ						*/	"Сумма"
/* ВИД ЗАТРАТ						*/	"бу видов затрат"
/* КОНТРАГЕНТЫ						*/	"бу контрагента"
/* НАПРАВЛЕНИЕ	*/	"бу направления"
/* ЭЛЕМЕНТЫ_ЗАТРАТ					*/	"бу элемента затрат"
/* ПРОЧЕЕ							*/	"бу прочих справочников"

)
  SET CREATENONMISSINGBLK ON;

  
  var ErrFlagScenario=0;
  var ErrFlagVersion=0;

  /* ПРОВЕРКА КОРРЕКТНОСТИ ВЫБОРА СЦЕНАРИЯ */
  FIX(/* Сценарий */ {СЦЕНАРИЙ} AND @LIST(&ОТКРЫТЫЕ_СЦЕНАРИИ))
    FIX(
    /* Сценарий */ 
    /* Версия   */ "Рабочая 1"
    )
     "бу статьи" (
     IF (ErrFlagScenario==0)
            ErrFlagScenario=1;
     ENDIF
     );

    ENDFIX
  ENDFIX

   /* ПРОВЕРКА КОРРЕКТНОСТИ ВЫБОРА ВЕРСИИ */
  FIX(/* Версия  */ {ВЕРСИЯ} AND @LIST(&ОТКРЫТЫЕ_ВЕРСИИ))
    FIX(
    /* Сценарий */ "Проект"
    /* Версия   */ 
    )
     "бу статьи" (
     IF (ErrFlagVersion==0)
            ErrFlagVersion=1;
     ENDIF
     );
    ENDFIX
  ENDFIX

  /* ВЫВОД СООБЩЕНИЙ О НЕКОРРЕКТНОМ СРЕЗЕ */
  FIX(
  /* Сценарий     */ "Проект"
  /* Версия       */ "Рабочая 1"
  )

   "бу статьи" (
    IF (ErrFlagScenario==0)
       @RETURN("Выбран сценарий, закрытый для расчета. Расчет не произведен.",ERROR);
    ENDIF
    IF (ErrFlagVersion==0)
       @RETURN("Выбрана версия, закрытая для расчета. Расчет не произведен.",ERROR);
    ENDIF
    )

   ENDFIX
ENDFIX
SET CREATENONMISSINGBLK OFF;
SET LOCKBLOCK HIGH;
/*чистим матрицу на Проект Рабочая 1*/

FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ								*/@RELATIVE("Всего по видам затрат (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Итого по продукции (пол-ль)", 0)
/*ПОКАЗАТЕЛИ                                        */"Кол-во"
/*НАПРАВЛЕНИЕ                     					*/"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */@RELATIVE({МВЗ},0)
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */"Рабочая 1"
/*СЦЕНАРИЙ                                          */"Проект"
/*ПЕРИОД                                            */"P0"
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*ВАЛЮТА                                            */"бу валюты"
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)   
/*ВИД ЗАТРАТ                                        */
/*ПРОЧЕЕ                                            */"бу прочих справочников"                           
)

FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
CLEARBLOCK ALL;
ENDFIXPARALLEL
ENDFIX


/*чистим базу на нужном сценарии и версии*/

FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ								*/"бу видов затрат (пол-ль)",@RELATIVE("Всего по видам затрат (пол-ль)",0),"ТехЭлемент (пол-ль)"
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Итого по продукции (пол-ль)", 0)
/*ПОКАЗАТЕЛИ                                        */"Кол-во","Драйвер","База","Сумма"
/*НАПРАВЛЕНИЕ                    					 */"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */@RELATIVE({МВЗ},0)
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */{ВЕРСИЯ}
/*СЦЕНАРИЙ                                          */{СЦЕНАРИЙ}
/*ПЕРИОД                                            */@Relative("Всего год", 0),"P0"
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*ВАЛЮТА                                            */"бу валюты"
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)   
/*ВИД ЗАТРАТ                                        */
/*ПРОЧЕЕ                                            */"бу прочих справочников"                           
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
CLEARBLOCK ALL;
ENDFIXPARALLEL


ENDFIX
FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ								*/"бу видов затрат (пол-ль)"
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/"бу вида продукции (пол-ль)"
/*ПОКАЗАТЕЛИ                                        */"Кол-во"
/*НАПРАВЛЕНИЕ                   					*/"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*МВЗ ПОЛУЧАТЕЛЬ                                    */
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */"Рабочая 1"
/*СЦЕНАРИЙ                                          */"Проект"
/*ПЕРИОД                                            */"P0"
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*ВАЛЮТА                                            */"бу валюты"
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)   
/*ВИД ЗАТРАТ                                        */
/*ПРОЧЕЕ                                            */"бу прочих справочников"                           
)
FIX(
/*МВЗ                                               */@RELATIVE("ТЧМ Итого",0) and @RELATIVE({МВЗ},0)
)

/*тирожируем на МВЗ получателей ТЧМ*/
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))

/* Start Template:ТЧМ.Plan2.TPL_Тиражирование Драйверов на получателей ТЧМ*/
DATACOPY "бу МВЗ (пол-ль)" to "ТЧМ в целом (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№1. Аглоцех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№2. Доменный цех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР Доменный цех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Доменные печи (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР ДП (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ДП1 (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ДП2 (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ДП3 (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "СТЧ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "УДЧ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч разливочных машин (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Установка придоменной грануляции шлака (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№3. Кислородный цех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР Кислородный цех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч пр-ва сжатого воздуха (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч пр-ва условного газа (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№6. ЦПДМШ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР ЦПДМШ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Копровый Уч (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч дробленный скрап (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч металлопродукции (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч щебень (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№8. ЦКРО (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР ЦКРО (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч стройиндустрии (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "БРУ (старая установка) (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "УПБ (новая установка) (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Ремонтные участки (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч ремонтов метал.оборудования (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч ремонтно-строительных работ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч ремонта ДП1 (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№9. Цех связи (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№10. ТЭРЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР ТЭРЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Ремонтные работы (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч. Разработка грунта (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№11. АСС (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№12. Автохозяйство (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР Автохозяйство (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Колонна грузовых машин. (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Колонна спецмашин. (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Колонна механизмов. (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№13. ЦЛХТиТК (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№15. ЦРМО (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР ЦРМО (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч пр-ва металлоконструкций (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Выполнение работ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№16. ТЭЦ-ПВС (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР ТЭЦ-ПВС (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч обессоленной воды (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч пр-ва пара ТЭЦ-ПВС (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч пр-ва электроэнергии ТЭЦ-ПВС (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч пр-ва дутья (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч химочищенной воды (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч пр-ва сжатого воздуха ТЭЦ-ПВС (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч пр-ва горячей воды ТЭЦ-ПВС (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№17. Энергоцех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР Энергоцех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч по разработке шлама аглодоменного (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч транспортировки и очистки промливневых стоков (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч УОШ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч питьевой воды (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч технической воды (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч перекачки и очистка хоз.-бытовых стоков (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч пара (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч горячей воды (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№18. Газовый цех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР Газовый цех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч очистки доменного газа (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч передачи природного газа (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№19. Электроцех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР Электроцех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч ремонтов электрооборудования цехов предприятия (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч передачи электроэнергии (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч ремонтов и обслуживания ОПС (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Электромастерская (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№20. Управление (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№21. РМЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР РМЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Ремонтно-механический Уч (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Литейный Уч (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№22. ИТЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№23. Цех питания (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№24. ЖДЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ЖДЦ без грузоперевозок (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР ЖДЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Работа локомотива_ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Работа кранов (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Провеска груза (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "УРПП (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Грузоперевозки_ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№25. ЦЛА (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№26. Хоз цех (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "№29. ЦОП (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "БО Металлург. (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Соцобъекты. (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ФОК (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Спортивно-стрелковый стенд (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Строительно-монтажное управление (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч.69,71 ОПР СМУ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч.65 (Строительные работы) (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч.66 (Монтажные работы) (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч.67 (Механо-монтажные работы) (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч.68 (Подготовка пр-ва) (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч.72 (Ремонт и обсл-е оборуд-я) (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч.73 (строительно-инженерных сетей) (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч.74 (Отделочные работы) (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч.75 (Дорожное стр-во) (пол-ль)";/* End Template:ТЧМ.Plan2.TPL_Тиражирование Драйверов на получателей ТЧМ*/

ENDFIXPARALLEL
ENDFIX

FIX(
/*МВЗ                                               */@RELATIVE("ТЧМС Итого",0) and @RELATIVE({МВЗ},0)
)

/*тирожируем на МВЗ получателей ТЧМ*/
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))

/* Start Template:ТЧМ.Plan2.TPL_Тиражирование Драйверов на получателей ТЧМС*/
DATACOPY "бу МВЗ (пол-ль)" to "ТЧМС в целом (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "СПЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР СПЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Прокатный стан 9501 (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Прокатный стан 9511 (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ККЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР ККЦ (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч непрерывной разливки стали (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч выплавки и обработки стали (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч брикетирования отходов (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч вакуумирования (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Отделение по переработке жидких шлаков (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Копровый уч. (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Энергоблок (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Уч водоподготовки (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Теплосиловой уч (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "ОПР Энергоблок (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Управление (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Лаборатория (пол-ль)";
DATACOPY "бу МВЗ (пол-ль)" to "Ремонтный цех (пол-ль)";/* End Template:ТЧМ.Plan2.TPL_Тиражирование Драйверов на получателей ТЧМС*/

ENDFIXPARALLEL
ENDFIX

ENDFIX



FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ								*/"бу видов затрат (пол-ль)"
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/"бу вида продукции (пол-ль)"
/*ПОКАЗАТЕЛИ                                        */
/*НАПРАВЛЕНИЕ                     					*/"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)	
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */@RELATIVE({МВЗ},0)
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */"Рабочая 1"
/*СЦЕНАРИЙ                                          */"Проект"
/*ПЕРИОД                                            */"P0"/*,@RELATIVE("Всего год",0)добавили итого год для технического среза выгрузки*/
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*ВАЛЮТА                                            */"бу валюты"
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)   
/*ВИД ЗАТРАТ                                        */ @RELATIVE("Всего по видам затрат",0)
/*ПРОЧЕЕ                                            */"бу прочих справочников"                           
)


"Кол-во" = "Кол-во"->"P0"*"ПЭО"->"бу видов затрат"->"бу видов затрат (пол-ль)"->"бу счета баланса"->"бу статьи"->"Сумма"->"P0";

FIX(
/*ПОКАЗАТЕЛИ                                        */"Кол-во"
)

CLEARBLOCK EMPTY;

ENDFIX

ENDFIX
SET LOCKBLOCK HIGH;

FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ								*/"бу видов затрат (пол-ль)"
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/
/*ПОКАЗАТЕЛИ                                        */"Кол-во"
/*НАПРАВЛЕНИЕ                    					 */"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */@RELATIVE({МВЗ},0)
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */"Рабочая 1"
/*СЦЕНАРИЙ                                          */"Проект"
/*ПЕРИОД                                            */"P0"
/*СЧЕТА БАЛАНСА                                     */@Relative("Драйвера распределения",0)
/*ВАЛЮТА                                            */"бу валюты"
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)   
/*ВИД ЗАТРАТ                                        */ 
/*ПРОЧЕЕ                                            */"бу прочих справочников"                           
)

FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
/* Start Template:ТЧМ.Plan2.TPL_Тиражирование Драйверов на продкты получатели*/
DATACOPY "бу вида продукции (пол-ль)" to "Основная продукция (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Чугун (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Чугун в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Чугун передельный (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Чугун передельный в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "ЧП рядовой (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "ЧП с Mn (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "ЧП с марганцем чистый по сод-нию S (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "ЧП низкофосфор. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "ЧП низкофосфор. чистый по сод-нию S (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "ЧП чистый по сод-нию с S (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Чугун с повыш. сод-нием S (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "LPS 30 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "LPS 30 Si (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "LPS 35 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "LPS 35 Si (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "LPS 40 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "LPS 40 Si (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "ЧЧС (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Чугун литейный (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Л1 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Л2 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Л3 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Л4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Л5 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Л6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Чугун литейный в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прокат (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прокат в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прокат арматурный из углеродистых сталей в прутках (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат из углеродистых сталей в прутках №8-10 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат из углеродистых сталей в прутках №12-18 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат из углеродистых сталей в прутках №20-40 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прокат арматурный из низколегированных сталей в прутках (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат из низколегированных сталей в прутках №8-10 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат из низколегированных сталей в прутках №12-18 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат из низколегированных сталей в прутках №20-40 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прокат арматурный из углеродистых сталей в мотках (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат из углеродистых сталей в мотках №6-8 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат из углеродистых сталей в мотках №10-16 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прокат арматурный из низколегированных сталей в мотках (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат из низколегированных сталей в мотках №6-8 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Арматурный прокат из низколегированных сталей в мотках №10-16 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Сортовой прокат (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прокат сортовой из рядовых сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Мелкий сортовой прокат из рядовых марок сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Крупный сортовой прокат из рядовых марок сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прокат сортовой из конструкционных марок сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Мелкий сортовой прокат из конструкционных марок сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Крупный сортовой прокат из конструкционных марок сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из низкоуглеродистых марок сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из низкоуглеродистых марок сталей, d4,5 - 5 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из низкоуглеродистых марок сталей, d5,5 - 6,5 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из низкоуглеродистых марок сталей, d7 - 22 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из низколегированных и легир-х марок сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из низколегированных и лег-х м-к сталей, d4,5-5 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из низколегированных и лег-х сталей, d5,5-6,5 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из низколегированных и легир-х  сталей, d7-22 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из высокоуглеродистых марок сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из высокоуглеродистых марок сталей, d4,5 - 5 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из высокоуглеродистых марок сталей, d5,5 - 6,5 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Катанка и круг в бунтах из высокоуглеродистых марок сталей, d7 - 22 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Фасонный прокат (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Мелкий фасонный прокат (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Средний фасонный прокат (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Крупный фасонный прокат (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Продукция вспомог. цехов (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "BRP B 25И12 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "BRA (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 10 П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 12,5 П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 (B 25) F100 П4 W6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 (B 25) F150 П4 W6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 (B 25) F300 П4 W6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 (B 25) F50 П4 W6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 F100 П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 F100 П4 W4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 F150 П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 F150 П4 W4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 F200 П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 F50 П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 F75 П4 W4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 15 П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 20 (мелкозернистый на подливку) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 20 F150 П4 W6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 20 F75 П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 20 П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 25 (мелкозернистый на подливку) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 25 F100 П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 25 F100 П4 W4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 25 F100 П4 W6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 25 F150 П4 W6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 25 F150 П5 W6 (сульфатостойкий) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 25 F200 П4 W6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 25 F300 П4 W6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 25 П4 W4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 25 П4 W6 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 30 F150 П4-П5 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 40 F75 П4-П5 W4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 7,5 F50 П3-П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон В 7,5 П3-П4 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон М (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон М 200. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон М 250 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон М 300. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетон М 350 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Раствор цементный (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Раствор М50 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Раствор М75 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Раствор М100 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Раствор М150 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Раствор М200 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "МПЗ собственного производства РМЦ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Мех.обработка изделий. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автоматическая наплавка (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Наплавка лентой (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Наплавка проволокой (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Наплавка электродами (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автоматическая наплавка в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Поковка (всего) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Поковка. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Буры (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Поковка в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Силикатный клей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Напыление порошка (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Плазменное напыление (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "для напыления колец резных (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "для напыления втулок соединительных (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Плазменная наплавка (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Напыление в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Кольцевая заготовка (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка из проката (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Патрубок газовый. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Фланец. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Рыло. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Фурмы (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "МПЗ собственного производства ЦРМО (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Производство стальных металлоконструкций (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Стальные металлоконструкции для собств.нужд (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Стальные металлоконструкции для реал.на сторну (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Металлоконструкции из нержавеющей стали. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Медные металлоконструкции. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Конус. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Обечайка. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бордюры (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бордюр дорожный (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бордюр тротуарный (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "МПЗ собственного производства ЦКРО (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "ЖБИ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Армокаркасы. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Монтажные петли. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "МПЗ собственного производства ТЭРЦ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "МПЗ собственного производства хозцеха (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Сушка пиломатериалов. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Швабра (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Ящик общего назначения (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Лопата для снега (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Оконная створка 1000 ? 800 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Клин (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Подставка (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Скамья (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Решетка для душа (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Рамка (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Доска обрезная на 1 м? (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Вывеска информацианная (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Дверной блок ДГ21-10П (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Подставка под кран (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Дверная коробка (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Оконный блок 1760*1500 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Оконная створка 350*680 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Дверной блок 800*2000 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Лестница 3 м (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Доска подоконная (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Двупольный дверной блок (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щит деревянный (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Деревянные изделия (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Полуфабрикаты собственного производства РМЦ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Литье (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Литье в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Чугунное литье (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бронзовое литье (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Медное литье (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Стальное литье (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Стальное литье в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Углеродистое литье (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Литье 70 ХЛ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Литье 110Г13Л (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Жидкая сталь на литье. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Жидкая сталь в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Жидкая сталь на углеродистое литье. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Жидкая сталь на литье 110Г13Л. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Жидкая сталь на литье 70 ХЛ. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Попутная продукция. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебень шлаковый (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебень шлаковый в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебень шлаковый фр.5-20 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебень шлаковый фр.10-40 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебень шлаковый фр. 10-80 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебень шлаковый фр.20-40 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебень шлаковый смесь 20-70. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебень шлаковый фр.40-70 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебень шлаковый фр.50-250 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебень шлаковый фр. 80-250 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Песок шлаковый фр. 0-5 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебеночно-песчаная смесь фр. 0-10 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Щебеночно-песчаная смесь фр. 0-70 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Граншлак (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Шлак жидкий на щебень (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Шлак на грануляцию (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Ковшевые остатки. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Потери газа (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Газ доменный другим цехам (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Газ доменный на каупера (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Смесь шлако-металлическая (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Аглодоменный шлам (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Коксовая мелочь (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Коксовый орех. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Выполнение работ, оказание услуг. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Лабораторные анализы (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Склад товарного чугуна (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Расходы по разливке чугуна (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Расходы по десульфурации чугуна (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги рем.цехов(РМЦ) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги рем.цехов(ЦРМО) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Рем. работы цехам (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Переработка металлоконструкций (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Изготовление строп и прочей пр-и (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Оборудование теплушек. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги ТЭРЦ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Рем. работы ТЭРЦ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Изготовление трубопроводов и прочего (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Разработка грунта. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги рем.цехов(ЦКРО) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Рем. работы уч. ремонта метал-ого оборудования (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Рем. работы уч. ремонтно-строительных работ. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Окраска металлоконструкций. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Рем. работы участка ремонта ДП-1 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги хозцеха (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги ЖДЦ в целом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "СМР для ЛПК (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Работа локомотива. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Работа крана. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Провеска. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Грузоперевозки. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Грузоперевозки сырья (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Грузоперевозки ГП (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Осмотр вагонов (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Выдача копий документов (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Раскредитование грузов (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "СМУ: (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Работы по погрузке разгрузке (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Резка металла (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Строительные работы (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Монтажные работы (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Ремонт и обслуживание электрооборудования (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Подготовка производства (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Механо-монтажные работы (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Отделочные работы (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Дорожное строительство (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Превышение ПДК (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прочие услуги (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Методическое руководство ГСС (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги электроцеха (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги прочие (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги по ремонту электрооборудования цехов п-п (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги электромастерской. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги по обслуживанию ОПС. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги автоцеха (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Колонна спецмашин (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автобусы ЛИАЗ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автобусы ПАЗ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автобусы УРАЛ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автовышки (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автовышки в лизинге (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Легковые автомобили (иномарки) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Легковые автомобили (отечественные) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Микроавтобусы (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Пожарные машины (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Специальные автомобили УАЗ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Грузопассажирские автомобили УАЗ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Легковые автомобили УАЗ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автокраны в лизинге до 25 т (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автокраны в лизинге до 50 т (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автокраны в лизинге до 70 т (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автокраны (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автокраны до 130 т (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автокраны до 16 т (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автокраны до 25 т (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автокраны до 40 т (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автомобили скорой помощи (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Выдача путевых листов (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Фургон-рефрижиратор (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "КМУ (манипулятор) по лизингу (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Колонна механизмов (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автопогрузчики в лизинге (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Погрузчики (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Погрузчики в лизинге (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Автопогрузчики (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Экскаваторы в лизинге (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Экскаваторы (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бульдозеры в лизинге (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бульдозеры (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Асфальтоукладчик (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Мини-погрузчик (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Экскаватор-погрузчик (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Экскаватор-погрузчик в лизинге (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Каток (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Каток в лизинге (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Погрузчики в лизинге 3 м3 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Погрузчики вилочные 5 т (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Погрузчики вилочные 2 т (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Погрузчики в лизинге 5 м3 (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Колонна грузовых машин (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бензовозы в лизинге (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бензовозы (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Грузовые машины (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Грузовые машины (г/п до 4 т) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Грузовые машины (г/п от 10 до 15 т) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Грузовые машины (г/п от 15 до 20 т) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Грузовые машины (г/п от 4 до 10 т) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Грузовые машины в лиз. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетононас. в лиз. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Комбинир. машины (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетоносмес. в лиз. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Бетоносмесители (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги по ремонту (собственные силы) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги участков (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги уч. строительства (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги по взвешиванию щебня (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги лаборатории (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги ЦЛА (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Услуги по ведению бух. учета (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Энергоресурсы. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Электроэнергия ТЭЦ-ПВС. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Электроэнергия с учетом передачи (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Пар ТЭЦ-ПВС. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Пар с учетом передачи (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Горячая вода с учетом передачи (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Горячая вода ТЭЦ-ПВС. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Обессоленная вода. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Очистка доменного газа (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Дутье. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Химочищенная вода. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Природный газ с учетом транспортировки (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Доменный газ очищенный (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прочие энергоресурсы (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Хоз.-бытовые стоки (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Питьевая вода. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Техническая вода. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Кислородная продукция (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Условный газ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Азот газообразный. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Азот газообразный в баллонах. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Азот газообразный в баллонах_ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Азот жидкий (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Сжатый воздух в баллонах (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Кислород газообразный в баллонах. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Кислород газообразный в баллонах_ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Кислород жидкий (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Кислород технический. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Кислород технологический. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Кислород технол. 95,0 КТА-12-3. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Кислород технол. 99,5 КА-5. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Сжатый воздух в целом. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Сжатый воздух кислород. Цеха. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Сжатый воздух ТЭЦ-ПВС. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Ремонт баллонов с вентилем (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Нанесение трафаретов (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прием пром-ливневых стоков (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Техническая вода подготовленная (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Деминерализованная вода. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Хозстоки (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Сжатый воздух (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Пар. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Горячая вода. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Продукция (сырье) собств. пр-ва (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Агломерат бункерный (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Агломерат скиповый. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Отсев агломерата. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Скрап дробленый (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Скрап переработанный. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Огневая резка металлолом (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Окалина переработанная (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Материал железосодержащий с УОШ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Шлам по ТУ 14-127-330. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Брикеты металлосодержащие (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Материал шихтовый МШ 1500. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Материал шихтовый МШ 50. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Материал шихтовый МШ 250. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Оборотный лом чугунный (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Оборотный лом стальной (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Чугун дробленый шлаковый (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "МК-250. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "МК-80. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "МК-50. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "МК-10. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Полуфабрикаты. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка стальная (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка стальная квадратного сечения из низкоуглеродистых сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка кв  150 (низкоуглерод. ст.) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка кв  180 (низкоуглерод. ст.) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка стальная квадратного сечения из конструкционных сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка кв  150 (констр. ст.) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка кв  180 (констр. ст.) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка стальная квадратного сечения из высокоуглеродистых сталей (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка кв  150 (высокоуглерод. ст.) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка кв  180 (высокоуглерод. ст.) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка стальная квадратного сечения из углеродистой стали (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка кв 150 (углерод.ст.) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка кв 180 (углерод.ст.) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка стальная квадратного сечения из низколегированной стали (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка кв  150 (низколег. ст.) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Заготовка кв  180 (низколег. ст.) (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Сталь жидкая. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Углеродистая сталь жидкая. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Низколегированная сталь жидкая. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Низкоуглеродистая сталь жидкая. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Конструкционная сталь жидкая. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Высокоуглеродистая сталь жидкая. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Прочая реализация. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Продажа ТМЦ. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Лом черных металлов. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Лом цветных металлов. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Коксовый орешек (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Коксовая мелочь. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Шлам аглодоменный. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Шлам аглодоменный с УОШ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Шлам аглодоменный по ТУ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Шлак доменный. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Известняк (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Сдача имущества в аренду_ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Аренда зем. участков (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Аренда помещений и ОС (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Аренда прочее (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Проч.реализация. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Соцобъекты: (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Базы отдыха, турбазы. (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Цех питания_ (пол-ль)";
DATACOPY "бу вида продукции (пол-ль)" to "Стрелковый стенд. (пол-ль)";/* End Template:ТЧМ.Plan2.TPL_Тиражирование Драйверов на продкты получатели*/

ENDFIXPARALLEL

ENDFIX
SET CALCPARALLEL 1;
SET CALCTASKDIMS 1;
FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ								*/"бу видов затрат (пол-ль)"
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Итого по продукции (пол-ль)", 0)
/*ПОКАЗАТЕЛИ                                        */
/*НАПРАВЛЕНИЕ                    					 */"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */@RELATIVE({МВЗ},0)
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */"Рабочая 1"
/*СЦЕНАРИЙ                                          */"Проект"
/*ПЕРИОД                                            */"P0"
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*ВАЛЮТА                                            */"бу валюты"
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)   
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0)
/*ПРОЧЕЕ                                            */                           
)

FIX(
/*ПРОЧЕЕ                                            */"бу прочих справочников"
)
"Кол-во" = "Кол-во"*"ПЭО"->"бу видов затрат"->"бу видов затрат (пол-ль)"->"бу счета баланса"->"бу статьи"->"Сумма"->"бу вида продукции (пол-ль)"->
@MEMBER(@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))->
@MEMBER(@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9))->"бу МВЗ (пол-ль)";

ENDFIX

FIX(
/*ПОКАЗАТЕЛИ                                        */"Кол-во"
/*ПРОЧЕЕ                                            */"бу прочих справочников"
)

CLEARBLOCK EMPTY;

ENDFIX

ENDFIX
SET LOCKBLOCK HIGH;
FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ								*/"бу видов затрат (пол-ль)"
/*ПОКАЗАТЕЛИ                                        */
/*НАПРАВЛЕНИЕ                     					*/"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ									*/"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */@RELATIVE({МВЗ},0)
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */
/*СЦЕНАРИЙ                                          */
/*ПЕРИОД                                            */"P0"
/*СЧЕТА БАЛАНСА                                     */@Relative("Драйвера распределения",0)
/*ВАЛЮТА                                            */"бу валюты"
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)   
/*ВИД ЗАТРАТ                                        */
/*ПРОЧЕЕ                                            */"бу прочих справочников"                           
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Итого по продукции (пол-ль)", 0)
)

FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
DATACOPY "Рабочая 1"->"Проект"->"Кол-во" to {ВЕРСИЯ}->{СЦЕНАРИЙ}->"База";
ENDFIXPARALLEL

ENDFIX


FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ								*/"бу видов затрат (пол-ль)"
/*ПОКАЗАТЕЛИ                                        */
/*НАПРАВЛЕНИЕ                    					 */"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */@RELATIVE({МВЗ},0)
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */{ВЕРСИЯ}
/*СЦЕНАРИЙ                                          */{СЦЕНАРИЙ}
/*ПЕРИОД                                            */"P0"
/*СЧЕТА БАЛАНСА                                     */@Relative("Драйвера распределения",0)
/*ВАЛЮТА                                            */"бу валюты"
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)   
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*ПРОЧЕЕ                                            */
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Итого по продукции (пол-ль)",0)
)
FIX(
/*ПРОЧЕЕ                                            */"бу прочих справочников"                           
)

"Кол-во"(
IF(NOT @ISMBR("Проект"->"Рабочая 1") )
	"Кол-во" ="База";
ENDIF
)
ENDFIX

FIX(
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@RELATIVE("Итого по продукции (пол-ль)",0)
/*ПРОЧЕЕ                                            */"бу прочих справочников"                           
/*ПОКАЗАТЕЛИ                                        */"База"
)

CLEARBLOCK ALL;

ENDFIX
ENDFIX
SET LOCKBLOCK HIGH;

FIX(
/*МВЗ                                               */@RELATIVE("ТЧМ Итого",0) and @RELATIVE({МВЗ},0)
)
FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ                              */ "бу видов затрат (пол-ль)"
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */
/*ПОКАЗАТЕЛИ                                        */
/*НАПРАВЛЕНИЕ                                        */"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*МВЗ ПОЛУЧАТЕЛЬ                                    */
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */{ВЕРСИЯ}
/*СЦЕНАРИЙ                                          */{СЦЕНАРИЙ}
/*ПЕРИОД                                            */@ILDESCENDANTS({СПИСОК_ПЕРИОД}) and @RELATIVE("Всего год",0)
/*СЧЕТА БАЛАНСА                                     */
/*ВАЛЮТА                                            */"бу валюты"
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)   
/*ВИД ЗАТРАТ                                        */
/*ПРОЧЕЕ                                            */"бу прочих справочников"                           
)
/*Расчет драйверов*/

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */@Relative("Итого по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: ФОТ"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
IF(@ISMBR("ОПР ДП (пол-ль)"))
/*Для распределения ОПР ДЦ не смотря на матрицу фот берется с ОПР ДП + ДП1 + ДП2+ ДП3*/
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
      *(
      @XREF(ТЧМ_1,"ФОТ.","RUR","Начисление","Оплата труда.","бу МВЗ (пол-ль)","Сумма",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
      +@XREF(ТЧМ_1,"Доменные печи","Чугун","ФОТ.","RUR","Начисление","Оплата труда.","бу МВЗ (пол-ль)","Сумма")
      );
ELSE 
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"ФОТ.","RUR","Начисление","Оплата труда.","бу МВЗ (пол-ль)","Сумма",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */@Relative("Итого по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Количество на продукте"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
   "Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
   *@XREF(ТЧМ_1,"Полная себестоимость","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","бу направления","Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)

ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */@Relative("Итого по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Шихта"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
   "Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
   *@XREF(ТЧМ_1,"Сырье и основные материалы.","Металлошихта","RUR","20_Начисление","бу МВЗ (пол-ль)","Кол-во",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)

ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */@Relative("Итого по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Сырье + Топливо в расходе минус газ природный (т)"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
*(
@XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","Сырье и основные материалы.","RUR","20_Начисление","бу МВЗ (пол-ль)","Кол-во",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
+@XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","Топливо технологическое.","RUR","20_Начисление","бу МВЗ (пол-ль)","Кол-во",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
-@XREF(ТЧМ_1,"Газ природный","Сырье и основные материалы.","RUR","20_Начисление","бу МВЗ (пол-ль)","Кол-во",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
-@XREF(ТЧМ_1,"Газ природный","Топливо технологическое.","RUR","20_Начисление","бу МВЗ (пол-ль)","Кол-во",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
);
ENDIF;)
ENDFIXPARALLEL
ENDFIX


FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */@Relative("Итого по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Объем реализации ЖД"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
/*
Драйвер расчитывается : Драйвер: Объем реализации ЖД = Объем реализации ЖД по Продукту (ВСЕХ МВЗ) * Объем произведенного продукта(КОНКР МВЗ)/Объем произведенного продукта (ВСЕХ МВЗ)  
*/
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
* 
(
/*объем перевозки ЖД на экспорт и СНГ*/
  @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМ в целом","Контрагенты ТЧМ и ТЧМС","ЖД отгрузка","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Кол-во","Валюты ввода",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))

+ @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМ в целом","Контрагенты ТЧМ и ТЧМС","Внутр рынок (ЖД)","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
*
(
/*Количество производенной продукции конкр мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
/
/*Количество производенной продукции всех мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR","ТЧМ Итого",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
;
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */@Relative("Итого по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Объем реализации Авто"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
/*
Драйвер расчитывается : Драйвер: Объем реализации ЖД = Объем реализации ЖД по Продукту (ВСЕХ МВЗ) * Объем произведенного продукта(КОНКР МВЗ)/Объем произведенного продукта (ВСЕХ МВЗ)  
*/
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
* 
(
/*объем перевозки ЖД на экспорт и СНГ*/
  @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМ в целом","Контрагенты ТЧМ и ТЧМС","Автоотгрузка","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Кол-во","Валюты ввода",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))

+ @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМ в целом","Контрагенты ТЧМ и ТЧМС","Внутр рынок (Авто)","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
*
(
/*Количество производенной продукции конкр мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
/
/*Количество производенной продукции всех мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR","ТЧМ Итого",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
;
ENDIF;)
ENDFIXPARALLEL
ENDFIX



FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */@Relative("Всего по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Выручка от реализации ТП"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
/*
Драйвер расчитывается так райвер: Выручка от реализации ТП = Выручка по Продукту (ВСЕХ МВЗ) * Объем произведенного продукта(КОНКР МВЗ)/Объем произведенного продукта (ВСЕХ МВЗ)
В дополнении к 02.00.1.7.Исключение ВЗ из распределения, добавляем возможность исключения продукта из распределени АУР 02.00.1.7.1.Исключение Продукта из распределения АУР
*/

"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"
*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1") 
*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1"->"бу видов затрат") 
*
(
/*Выручка реализации основной продукции*/
  @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМ в целом","Контрагенты ТЧМ и ТЧМС","Направления","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Сумма","Рубль (расчет)",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
*
(
/*Количество производенной продукции конкр мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
/
/*Количество производенной продукции всех мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR","ТЧМ Итого",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
;
ENDIF;)
ENDFIXPARALLEL
ENDFIX


FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */@Relative("Всего по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Общий объем реализации"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
/*
Драйвер расчитывается так райвер: Общий объем реализации = Объем проданного продукта (ВСЕХ МВЗ) * Объем произведенного продукта (КОНКР МВЗ)/Объем произведенного продукта (ВСЕХ МВЗ)
*/

"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1") 
*
(
/*Объем реализации основной продукции*/
  @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМ в целом","Контрагенты ТЧМ и ТЧМС","Направления","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Кол-во","Валюты ввода",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
*
(
/*Количество производенной продукции конкр мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
/
/*Количество производенной продукции всех мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR","ТЧМ Итого",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
);
ENDIF;)
ENDFIXPARALLEL
ENDFIX


FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */@Relative("Итого по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Продукция участка"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
"Драйвер"(
IF("Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1") 
*
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
;
ENDIF;
)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№2. Доменный цех (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Чугун в пересчете на передельный"
)

FIXPARALLEL(8,@DESCENDANTS("Чугун (пол-ль)"))
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"бу видов затрат","RUR","бу контрагента","Тов. пр-ция (сч 43)","бу прочих справочников","ПТО","бу элемента затрат","бу статьи","20_Выбытие","бу МВЗ (пол-ль)","Кол-во в пересчете на передельный",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX


FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№2. Доменный цех (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Чугун"
)

FIXPARALLEL(8,@DESCENDANTS("Чугун (пол-ль)"))
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"бу видов затрат","RUR","бу контрагента","Тов. пр-ция (сч 43)","бу прочих справочников","ПТО","бу элемента затрат","бу статьи","20_Выбытие","бу МВЗ (пол-ль)","Кол-во с учетом годного выхода",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№2. Доменный цех (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Объем разлитого чугуна"
)

FIXPARALLEL(8,@DESCENDANTS("Чугун (пол-ль)"))
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПТО","бу элемента затрат","бу статьи","20_Выбытие","бу МВЗ (пол-ль)","Кол-во разлитого чугуна","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№2. Доменный цех (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Доменный газ"
)
/*не понятно*/
FIXPARALLEL(8,@DESCENDANTS("Чугун (пол-ль)"))
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"Газ доменный на каупера.","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","ПОПУТНАЯ ПРОДУКЦИЯ","20_Начисление","бу МВЗ (пол-ль)","Сумма","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№2. Доменный цех (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Объем десульфурации чугуна"
)

FIXPARALLEL(8,@DESCENDANTS("Чугун (пол-ль)"))
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
*@XREF(ТЧМ_1,"Проволока ПП","бу контрагента","бу направления","бу прочих справочников","ПТО","бу элемента затрат","Сырье и основные материалы.","20_Начисление","бу МВЗ (пол-ль)","Норма на ед.","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))

*@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
;
ENDIF;)
ENDFIXPARALLEL
ENDFIX


FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№2. Доменный цех (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Расход топлива (кокс +коксовый орех)"
)

FIXPARALLEL(8,@DESCENDANTS("Чугун (пол-ль)"))
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
*(
@XREF(ТЧМ_1,"Кокс влажный скиповой","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Топливо технологическое.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
+@XREF(ТЧМ_1,"Коксовый орех","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Топливо технологическое.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
/*+@XREF(ТЧМ_1,"Коксовая мелочь с РВО","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Топливо технологическое.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))*/
+@XREF(ТЧМ_1,"Коксовая мелочь с печей","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Топливо технологическое.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
);
ENDIF;)
ENDFIXPARALLEL
ENDFIX


FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */"бу вида продукции (пол-ль)"
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Амортизация"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"Амортизация ОС и НМА","бу контрагента","бу направления","бу вида продукции","Всего по группам ОС и НМА","Финансовый отд","Всего по категориям ОС","Амортизация ОС и НМА.","02_Начисление аморт-ии","Сумма",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№12. Автохозяйство (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */@Relative("Услуги автоцеха (пол-ль)",0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Тарифный фонд (Автоцех)"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","№12 Автохозяйство","бу элемента затрат","бу статьи","20_Выбытие","бу МВЗ (пол-ль)","Тарифный фонд","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№12. Автохозяйство (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */@Relative("Услуги автоцеха (пол-ль)",0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Командировочные расходы (Автоцех)"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"№12 Автохозяйство","бу видов затрат","бу контрагента","бу направления","бу прочих справочников","бу элемента затрат","бу статьи","20_Выбытие","бу МВЗ (пол-ль)","Кол-во на командировки","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX


FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№12. Автохозяйство (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */@Relative("Услуги автоцеха (пол-ль)",0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: ГСМ"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"Топливо транспортное","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Топливо технологическое.","20_Начисление","бу МВЗ (пол-ль)","Сумма","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№3. Кислородный цех (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Коэффициент эксергии"
)

FIXPARALLEL(8,@DESCENDANTS("Кислородная продукция (пол-ль)"))

/*
На срезе сохранен объем продукции в ед-х условного газа, который и берем за базу
"бу видов затрат"->"Уч пр-ва условного газа"->"бу контрагента"->"бу направления"->"бу прочих справочников"->"ПЭО"->"бу элемента затрат"->"бу статьи"->"20_Начисление"->"бу МВЗ (пол-ль)"->"Кол-во"->"RUR"*/

"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
                     *@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","бу статьи","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
                    ;
                    
                    /*@XREF(ТЧМ_1,"Сжатый воздух в целом","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Энергозатраты на технологию","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));*/
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("№6. ЦПДМШ (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Железо"
)

FIXPARALLEL(8,@DESCENDANTS("Продукция (сырье) собств. пр-ва (пол-ль)"))
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу напр-я списания","бу прочих справочников","ПЭО","бу элемента затрат","бу статьи","20_Выбытие","Уч металлопродукции (пол-ль)","Содержание железа в т","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@Relative("Уч металлопродукции (пол-ль)",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */@SIBLINGS("Чугун дробленый шлаковый (пол-ль)")
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Металлопродукция кроме ЧДШ"
)

"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIX


/*Агрегацимя Драйверов*/
FIX(
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*ПОКАЗАТЕЛИ                                          */"Драйвер"
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
)

AGG("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ");
ENDFIX

FIX(
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*ПОКАЗАТЕЛИ                                       */"Драйвер"
/*МВЗ ПОЛУЧАТЕЛЬ                                   */
/*СЧЕТА БАЛАНСА                                    */@RELATIVE("Драйвера распределения",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */"Продукция получатель ТЧМ и ТЧМС"
)

AGG("МВЗ ПОЛУЧАТЕЛЬ");
ENDFIX

/*Расчет Базы*/
FIX(
/*ВИД ЗАТРАТ                                        */
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0) 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */@Relative("Итого по продукции (пол-ль)", 0)
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
"База" = "Драйвер"/"Драйвер"->"МВЗ получатели"->"Продукция получатель ТЧМ и ТЧМС"
      ;
ENDFIXPARALLEL
ENDFIX

/*

Зачистка агрегатов*/

FIX(
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*МВЗ ПОЛУЧАТЕЛЬ                                    */"МВЗ получатели"
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                              */@Relative("Итого по продукции (пол-ль)", 0),"Продукция получатель ТЧМ и ТЧМС"
/*СЧЕТА БАЛАНСА                                     */"Драйвер" 
)
 CLEARBLOCK ALL;

ENDFIX


ENDFIX

ENDFIX
SET LOCKBLOCK HIGH;

FIX(
/*МВЗ                                               */@RELATIVE("ТЧМС Итого",0) and @RELATIVE({МВЗ},0)
)
FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ								*/ "бу видов затрат (пол-ль)"
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/
/*ПОКАЗАТЕЛИ                                        */
/*НАПРАВЛЕНИЕ                     					*/"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*МВЗ ПОЛУЧАТЕЛЬ                                    */
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */{ВЕРСИЯ}
/*СЦЕНАРИЙ                                          */{СЦЕНАРИЙ}
/*ПЕРИОД                                            */@ILDESCENDANTS({СПИСОК_ПЕРИОД}) and @RELATIVE("Всего год",0)
/*СЧЕТА БАЛАНСА                                     */
/*ВАЛЮТА                                            */"бу валюты"
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)   
/*ВИД ЗАТРАТ                                        */
/*ПРОЧЕЕ                                            */"бу прочих справочников"                           
)
/*Расчет драйверов*/

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Итого по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Продукция участка"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
"Драйвер"(
IF("Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1") 
*
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
;
ENDIF;
)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Итого по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: ФОТ"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"ФОТ.","RUR","Начисление","Оплата труда.","бу МВЗ (пол-ль)","Сумма",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        		*/@Relative("Итого по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Количество на продукте"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
	"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
	*@XREF(ТЧМ_1,"Полная себестоимость","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","бу направления","Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)

ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Всего по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Объем реализации ЖД"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
/*
Драйвер расчитывается так райвер: Драйвер: Объем реализации ЖД = Объем реализации ЖД по Продукту (ВСЕХ МВЗ) * Объем произведенного продукта(КОНКР МВЗ)/Объем произведенного продукта (ВСЕХ МВЗ)  
*/
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
* 
(
/*объем перевозки ЖД на экспорт и СНГ*/
  @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМС в целом","Контрагенты ТЧМ и ТЧМС","ЖД отгрузка","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Кол-во","Валюты ввода",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))

+ @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМС в целом","Контрагенты ТЧМ и ТЧМС","Внутр рынок (ЖД)","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
*
(
/*Количество производенной продукции конкр мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
/
/*Количество производенной продукции всех мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR","ТЧМС Итого",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
;
ENDIF;)
ENDFIXPARALLEL
ENDFIX

FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Всего по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Объем реализации Авто"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
/*
Драйвер расчитывается так райвер: Драйвер: Объем реализации ЖД = Объем реализации ЖД по Продукту (ВСЕХ МВЗ) * Объем произведенного продукта(КОНКР МВЗ)/Объем произведенного продукта (ВСЕХ МВЗ)  
*/
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")
* 
(
/*объем перевозки ЖД на экспорт и СНГ*/
  @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМС в целом","Контрагенты ТЧМ и ТЧМС","Автоотгрузка","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Кол-во","Валюты ввода",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))

+ @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМС в целом","Контрагенты ТЧМ и ТЧМС","Внутр рынок (Авто)","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
*
(
/*Количество производенной продукции конкр мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
/
/*Количество производенной продукции всех мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR","ТЧМС Итого",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
;
ENDIF;)
ENDFIXPARALLEL
ENDFIX



FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Всего по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Выручка от реализации ТП"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
/*
Драйвер расчитывается так райвер: Выручка от реализации ТП = Выручка по Продукту (ВСЕХ МВЗ) * Объем произведенного продукта(КОНКР МВЗ)/Объем произведенного продукта (ВСЕХ МВЗ)
В дополнении к 02.00.1.7.Исключение ВЗ из распределения, добавляем возможность исключения продукта из распределени АУР 02.00.1.7.1.Исключение Продукта из распределения АУР
*/

"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"
*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1") 
*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1"->"бу видов затрат")
*
(
/*Выручка реализации основной продукции*/
  @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМС в целом","Контрагенты ТЧМ и ТЧМС","Направления","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Сумма","Рубль (расчет)",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
*
(
/*Количество производенной продукции конкр мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
/
/*Количество производенной продукции всех мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR","ТЧМС Итого",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
;
ENDIF;)
ENDFIXPARALLEL
ENDFIX


FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Всего по продукции (пол-ль)", 0)
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Общий объем реализации"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
/*
Драйвер расчитывается так райвер: Общий объем реализации = Объем проданного продукта (ВСЕХ МВЗ) * Объем произведенного продукта (КОНКР МВЗ)/Объем произведенного продукта (ВСЕХ МВЗ)
*/

"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"
*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1") 
*
(
/*Объем реализации основной продукции*/
  @XREF(ТЧМ_1,"ВИДЫ ЗАТРАТ ТЧМ И ТЧМС","ТЧМС в целом","Контрагенты ТЧМ и ТЧМС","Направления","ПРОЧИЕ СПРАВОЧНИКИ ТЧМ и ТЧМС","Центры финансовой ответсвенности","ЭЛЕМЕНТЫ ЗАТРАТ ТЧМ И ТЧМС","Поступления от реализации","62_Реализация без НДС","бу МВЗ (пол-ль)","Кол-во","Валюты ввода",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
)
*
(
/*Количество производенной продукции конкр мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9),@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
/
/*Количество производенной продукции всех мвз */
@XREF(ТЧМ_1,"бу видов затрат","бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Кол-во с учетом годного выхода.","20_Начисление","бу МВЗ (пол-ль)","Кол-во","RUR","ТЧМС Итого",@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))
);
ENDIF;)
ENDFIXPARALLEL
ENDFIX






FIX( 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/"бу вида продукции (пол-ль)"
/*СЧЕТА БАЛАНСА                                     */"Драйвер: Амортизация"
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат")) 
"Драйвер"(
IF( "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"+0 > 0)
"Драйвер" = "Кол-во"->"P0"-> "бу видов затрат (пол-ль)"*(1-"Кол-во"->"P0"-> "бу видов затрат (пол-ль)"->"бу счета баланса"->"Содержание основных фондов"->"Рабочая 1")*@XREF(ТЧМ_1,"Амортизация ОС и НМА","бу контрагента","бу направления","бу вида продукции","Всего по группам ОС и НМА","Финансовый отд","Всего по категориям ОС","Амортизация ОС и НМА.","02_Начисление аморт-ии","Сумма",@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9));
ENDIF;)
ENDFIXPARALLEL
ENDFIX


/*Агрегацимя Драйверов*/
FIX(
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*ПОКАЗАТЕЛИ                                       	*/"Драйвер"
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
)

AGG("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ");
ENDFIX

FIX(
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*ПОКАЗАТЕЛИ                                       */"Драйвер"
/*МВЗ ПОЛУЧАТЕЛЬ                                   */
/*СЧЕТА БАЛАНСА                                    */@RELATIVE("Драйвера распределения",0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/"Продукция получатель ТЧМ и ТЧМС"
)

AGG("МВЗ ПОЛУЧАТЕЛЬ");
ENDFIX

/*Расчет Базы*/
FIX(
/*ВИД ЗАТРАТ                                        */
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0) 
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/@Relative("Итого по продукции (пол-ль)", 0)
)
FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))
"База" = "Драйвер"/"Драйвер"->"МВЗ получатели"->"Продукция получатель ТЧМ и ТЧМС";
ENDFIXPARALLEL
ENDFIX

/*Зачистка агрегатов*/

FIX(
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/"Продукция получатель ТЧМ и ТЧМС"
/*СЧЕТА БАЛАНСА                                     */"Драйвер" 
)
/*
CLEARBLOCK ALL;
*/
ENDFIX



FIX(
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0) 
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*МВЗ ПОЛУЧАТЕЛЬ                                    */"МВЗ получатели"
/*ПРОДУКТ ПОЛУЧАТЕЛЬ								*/"Продукция получатель ТЧМ и ТЧМС"
/*СЧЕТА БАЛАНСА                                     */"Драйвер" 
)

CLEARBLOCK ALL;
ENDFIX



ENDFIX
ENDFIX

SET LOCKBLOCK HIGH;


FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ                        */"бу видов затрат (пол-ль)"
/*ПОКАЗАТЕЛИ                                        */
/*НАПРАВЛЕНИЕ                                    */"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */@RELATIVE({МВЗ},0)
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */{ВЕРСИЯ}
/*СЦЕНАРИЙ                                          */{СЦЕНАРИЙ}
/*ПЕРИОД                                            */@ILDESCENDANTS({СПИСОК_ПЕРИОД}) and @RELATIVE("Всего год",0)
/*ВАЛЮТА                                            */"бу валюты"
/*СЧЕТА БАЛАНСА                                     */
/*СТАТЬИ                                            */
/*ВИД ЗАТРАТ                                        */
/*ПРОЧЕЕ                                            */"бу прочих справочников"
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        */
)

/*ЧИСТИМ БАЗЫ БЕЗ ДАННЫХ*/

FIX(
/*СЧЕТА БАЛАНСА                                     */@REMOVE(@RELATIVE("Драйвера распределения",0),@LIST("Драйвер: Амортизация"))
/*СТАТЬИ                                            */@REMOVE(@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0),"Амортизация ОС и НМА.")
/*ВИД ЗАТРАТ                                        */@REMOVE(@RELATIVE("Всего по видам затрат",0),@LIST(@RELATIVE("Налоги",0),"Амортизация ОС и НМА"))
)
FIXPARALLEL(8,@DESCENDANTS("Итого по продукции (пол-ль)"))
"База"(
IF(
(
@ISDESC("Всего по продукции (пол-ль)") and
@XREF(ТЧМ_1,"бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Начисление","бу МВЗ (пол-ль)","Сумма","RUR","ПОЛНАЯ СЕБЕСТОИМОСТЬ")
+@XREF(ТЧМ_1,"бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Начисление","бу МВЗ (пол-ль)","Кол-во","RUR","ПОЛНАЯ СЕБЕСТОИМОСТЬ")+0==0
) or 
(
@ISMBR("бу вида продукции (пол-ль)") and
@XREF(ТЧМ_1,"бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Начисление","бу МВЗ (пол-ль)","Сумма","RUR","ПОЛНАЯ СЕБЕСТОИМОСТЬ")
+@XREF(ТЧМ_1,"бу контрагента","бу направления","бу прочих справочников","ПЭО","бу элемента затрат","Начисление","бу МВЗ (пол-ль)","Кол-во","RUR","ПОЛНАЯ СЕБЕСТОИМОСТЬ")+0==0
and {МВЗ}->@MEMBER(@CONCATENATE(@NAME(@CURRMBR("МВЗ"))," (пол-ль)"))->@MEMBER(@CONCATENATE(@NAME(@CURRMBR("ВИД_ЗАТРАТ"))," (пол-ль)"))->"бу вида продукции (пол-ль)"->"бу видов затрат"->"бу контрагента"->"бу направления"->"бу прочих справочников"->"ПЭО"->"бу элемента затрат"->"бу статьи"/*"ПОЛНАЯ СЕБЕСТОИМОСТЬ"*/->"Драйвер: Продукция участка"->"База"+0==0
)
)   
"База"->@MEMBER(@CONCATENATE(@NAME(@CURRMBR("ВИД_ЗАТРАТ"))," (пол-ль)"))=#missing;
ENDIF)


ENDFIXPARALLEL

ENDFIX
/*ПЕРЕНОСИМ НА ВЗ ПОЛУЧАТЕЛЬ*/
FIX(
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*СТАТЬИ                                            */@RELATIVE("ПОЛНАЯ СЕБЕСТОИМОСТЬ",0)
/*ВИД ЗАТРАТ                                        */@RELATIVE("Всего по видам затрат",0)
)
FIXPARALLEL(8,@DESCENDANTS("Итого по продукции (пол-ль)"))

"База"(
IF("База"!=#missing)
IF(@ISMBR(@LIST("Управление","№9. Цех связи","№11. АСС","№13. ЦЛХТиТК","№20. Управление","№22. ИТЦ","№23. Цех питания","№25. ЦЛА","№26. Хоз цех","№29. ЦОП")))
@XWRITE("База",@LOOPBACK,"База","Общехозяйственные расходы (пол-ль)");
@XWRITE("Драйвер",@LOOPBACK,"Драйвер","Общехозяйственные расходы (пол-ль)");
ELSE
@XWRITE("База",@LOOPBACK,"База",@CONCATENATE(@NAME(@CURRMBR("ВИД_ЗАТРАТ"))," (пол-ль)"));
@XWRITE("Драйвер",@LOOPBACK,"Драйвер",@CONCATENATE(@NAME(@CURRMBR("ВИД_ЗАТРАТ"))," (пол-ль)"));
ENDIF
ENDIF)

ENDFIXPARALLEL
ENDFIX

ENDFIX
FIX(
/*ВИД ЗАТРАТ ПОЛУЧАТЕЛЬ                        		*/"бу видов затрат (пол-ль)"
/*ПОКАЗАТЕЛИ                                        */
/*НАПРАВЛЕНИЕ                                    	*/"бу направления"
/*КОНТРАГЕНТЫ                                       */"бу контрагента"
/*ЦФО                                               */"ПЭО"
/*ЭЛЕМЕНТЫ_ЗАТРАТ                                   */"бу элемента затрат"
/*ПРОДУКЦИЯ                                         */"бу вида продукции"
/*МВЗ                                               */@RELATIVE({МВЗ},0)/*использую верхний элемент за не имением лучшего*/
/*ГОД                                               */{ГОД}
/*ВЕРСИЯ                                            */{ВЕРСИЯ}
/*СЦЕНАРИЙ                                          */{СЦЕНАРИЙ}
/*ПЕРИОД                                            */@ILDESCENDANTS({СПИСОК_ПЕРИОД}) and @RELATIVE("Всего год",0)
/*ВАЛЮТА                                            "бу валюты"*/
/*СЧЕТА БАЛАНСА                                     */
/*СТАТЬИ                                            */
/*ВИД ЗАТРАТ                                        */
/*ПРОЧЕЕ                                            */"бу прочих справочников"
/*МВЗ ПОЛУЧАТЕЛЬ                                    */@RELATIVE(@MEMBER(@CONCATENATE(@NAME({МВЗ})," (пол-ль)")),0)
/*ПРОДУКТ ПОЛУЧАТЕЛЬ                        		*/@REMOVE(@RELATIVE("Всего по продукции (пол-ль)",0),@RELATIVE("Основная продукция (пол-ль)",0))
)
FIX(
/*СЧЕТА БАЛАНСА                                     */@RELATIVE("Драйвера распределения",0)
/*СТАТЬИ                                            */@RELATIVE("ПРОИЗВОДСТВЕННАЯ СЕБЕСТОИМОСТЬ",0)
/*ВИД ЗАТРАТ                                        */
)

FIXPARALLEL(8,@DESCENDANTS("Всего по видам затрат"))


"База"(
IF("База" > 0)
IF(
/*отключаем тупиковую ветку*/
NOT @ISMBR("ТЧМ в целом") and NOT @ISMBR("ТЧМС в целом")
)
"База"->"Сырье и основные материалы."->"Драйвер: Продукция участка"
->"ТехЭлемент (пол-ль)"
->@MEMBER(@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9))
->@MEMBER(@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))=1;

/*"База"->"Сырье и основные материалы."->"ТехЭлемент (пол-ль)"->"Драйвер: Продукция участка"

->@MEMBER(@SUBSTRING(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("МВЗ ПОЛУЧАТЕЛЬ")))-9))
->@MEMBER(@SUBSTRING(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")),0,@CalcMgrTextLength(@NAME(@CURRMBR("ПРОДУКЦИЯ ПОЛУЧАТЕЛЬ")))-9))=1;
*/
ENDIF
ENDIF)

ENDFIXPARALLEL
ENDFIX

ENDFIX]]></script>
    </rule>
  </rules>
  <components></components>
</HBRRepo>